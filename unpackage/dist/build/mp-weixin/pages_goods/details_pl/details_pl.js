(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages_goods/details_pl/details_pl"],{"0c53":function(t,e,o){"use strict";o.r(e);var n=o("4ba6"),i=o("49bf");for(var s in i)"default"!==s&&function(t){o.d(e,t,(function(){return i[t]}))}(s);o("49d3");var a,c=o("f0c5"),r=o("3029"),g=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"82a561ea",null,!1,n["a"],a);"function"===typeof r["a"]&&Object(r["a"])(g),e["default"]=g.exports},"1a5b":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(o("b704")),i=o("2f62");function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function c(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach((function(e){r(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function r(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var g=function(){Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup")]).then(function(){return resolve(o("f66d"))}.bind(null,o)).catch(o.oe)},u={components:{uniPopup:g},data:function(){return{pl_type:-1,data_list:[],cur_swiper:1,btn_kg:0,btnkg:0,g_id:"",v_id:"",dy_id:"",advocacyviceId:"",dyr_type:0,sheetshow:!1,sheetshow1:!1,goodsData:"",guige_arr:[],guige_arr_show:[],guige_select:[],show_pri:0,show_img:0,show_num:0,type1:[-1],ggshow1_jjj:[],cnum:0,star_list:[],star_page:1,size:20,comment_tag:[],goods_sku_id:0}},computed:c(c({},(0,i.mapState)(["hasLogin","loginMsg","wxlogin"])),{},{ggshow1:function(){var t=this.guige_select;if(t){for(var e=[],o=0;o<t.length;o++)t[o]&&t[o].value&&e.push(t[o].value);return console.log(e.join(",")),e.join(",")}}}),onLoad:function(t){this.g_id=t.id,this.onRetry(),t.dy_id&&(this.dy_id=t.dy_id,this.advocacyviceId=t.advocacyviceId)},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){this.onRetry()},onReachBottom:function(){this.getStarlist()},onShareAppMessage:function(){},methods:{onRetry:function(){this.getSku(),this.star_page=1,this.getStarlist()},toroom:function(e){this.hasLogin?(this.$store.commit("createConversationActive",e),t.navigateTo({url:"/pages/tim/room?id="+e+"&type=2"})):t.navigateTo({url:"/pagesA/login/login"})},scFuc:function(e,o){var i=this,s={token:i.loginMsg.userToken,type:5,id:e,operate:o};"affirm"!=o?wx.showModal({title:"提示",content:"是否取消收藏?",success:function(e){e.confirm?(console.log("用户点击确定"),n.default.P_post("/attention/operation",s).then((function(e){console.log(e),i.btnkg=0,-1!=e.code&&(0!=e.code||"请先登录账号~"!=e.msg)?1==e.code&&(i.getSku(),t.showToast({icon:"none",title:"操作成功"})):t.navigateTo({url:"/pagesA/login/login"})})).catch((function(e){i.btnkg=0,console.log(e),t.showToast({icon:"none",title:"操作失败"})}))):e.cancel&&console.log("用户点击取消")}}):n.default.P_post("/attention/operation",s).then((function(e){console.log(e),i.btnkg=0,-1!=e.code&&(0!=e.code||"请先登录账号~"!=e.msg)?1==e.code&&(i.getSku(),t.showToast({icon:"none",title:"操作成功"})):t.navigateTo({url:"/pagesA/login/login"})})).catch((function(e){i.btnkg=0,console.log(e),t.showToast({icon:"none",title:"操作失败"})}))},getStarlist:function(){var e=this,o="/goods/goodsAppraise",i={gid:e.g_id,tag:-1==e.pl_type?"":e.pl_type,is_later:1,token:e.loginMsg.userToken,page:e.star_page,size:e.size};n.default.P_get(o,i).then((function(o){if(e.btn_kg=0,console.log(o),1==o.code){var n=o.data.comment;if("string"==typeof n&&(n=JSON.parse(n)),0==n.length)return e.star_page>1&&t.showToast({icon:"none",title:"暂无更多数据"}),void(e.btn_kg=0);1==e.star_page?e.star_list=n:e.star_list=e.star_list.concat(n),e.btn_kg=0,e.star_page++}})).catch((function(o){e.btn_kg=0,console.log(o),t.showToast({icon:"none",title:"获取数据失败"})}))},getSku:function(){var e=this,o={token:e.loginMsg.userToken,id:e.g_id};n.default.P_get("/goods/details",o).then((function(t){if(console.log(t),1==t.code){var o=JSON.stringify(t.data.attr.sku_all),n=JSON.stringify(t.data.attr.specification);console.log(o),e.guige=JSON.parse(o),e.guige_arr_show=JSON.parse(n),e.guige_arr=t.data.attr.specification,e.goodsData=t.data,e.comment_tag=t.data.comment.tag,e.show_img=t.data.img,e.show_pri=t.data.current_price,e.show_num=0}})).catch((function(e){console.log(e),t.showToast({icon:"none",title:"获取数据失败"})}))},guanzhuFuc:function(e,o,i){var s=this,a={token:s.loginMsg.userToken,type:e,id:o,operate:i};1!=s.btn_kg&&(s.btn_kg=1,n.default.P_post("/attention/operation",a).then((function(e){if(console.log(e),s.btn_kg=0,-1!=e.code)if(0!=e.code||"请先登录账号~"!=e.msg){if(1==e.code){for(var n=0;n<s.star_list.length;n++)s.star_list[n].id==o&&("affirm"==i?(s.$set(s.star_list[n],"is_praise",1),s.$set(s.star_list[n],"like_sum",s.star_list[n].like_sum-1+2)):(s.$set(s.star_list[n],"is_praise",2),s.$set(s.star_list[n],"like_sum",s.star_list[n].like_sum-1)));t.showToast({icon:"none",title:"操作成功"})}}else t.navigateTo({url:"/pagesA/login/login"});else t.navigateTo({url:"/pagesA/login/login"})})).catch((function(e){s.btn_kg=0,console.log(e),t.showToast({icon:"none",title:"操作失败"})})))},ggShow:function(t,e,o){for(var n=this,i={name:t,value:e},s=[],a=0;a<n.guige.length;a++){for(var c=JSON.stringify(n.guige[a].sku),r=!0,g=0;g<n.guige_arr.length;g++){var u=!1;if(n.guige_select[g]&&(u=JSON.stringify(n.guige_select[g])),g==o&&(u=JSON.stringify(i)),console.log("false"==u),u&&"false"!=u){if(-1==c.indexOf(u)){r=!1;break}}else r=!0}r&&s.push(n.guige[a])}return s.length>0},selegg:function(t){var e=this;console.log(t.currentTarget.dataset.value);var o={name:t.currentTarget.dataset.name,value:t.currentTarget.dataset.value},n=JSON.stringify(e.guige_select),i=JSON.stringify(o);-1==n.indexOf(i)?e.$set(e.guige_select,t.currentTarget.dataset.ggidx,o):e.$set(e.guige_select,t.currentTarget.dataset.ggidx,!1);for(var s=[],a=0;a<e.guige.length;a++){n=JSON.stringify(e.guige[a].sku);for(var c=!0,r=0;r<e.guige_select.length;r++)if(e.guige_select[r]){i=JSON.stringify(e.guige_select[r]);if(i.length>0&&-1==n.indexOf(i)){c=!1;break}}else c=!0;c&&s.push(e.guige[a])}t.currentTarget.dataset.ggidx;var g=0,u=0,l="";console.log(s);for(a=0;a<s.length;a++)g+=s[a].number,0==u&&(e.v_id=s[a].v_id,u=s[a].current_price),""==l&&(l=s[a].v_img);e.show_pri=u,e.show_num=g,g<e.cnum&&(e.cnum=g),g>0&&0==e.cnum&&(e.cnum=1),e.show_img=l,0==e.show_img.length&&(e.show_img=e.goodsData.img),0==e.show_pri&&(e.show_pri=e.goodsData.current_price)},onChange:function(e){var o=this;e.currentTarget.dataset.selec;if(2!=o.goodsData.is_pond_goods)return 0==o.guige_select.length?(t.showToast({icon:"none",title:"请先选择规格"}),void(this.cnum=0)):void(this.cnum>this.show_num?this.cnum=this.show_num:this.cnum=e.detail);this.cnum=1},jump:function(t){1!=this.btn_kg&&(this.btn_kg=1,setTimeout((function(){this.btn_kg=0}),1e3),console.log(t.currentTarget.dataset.type),n.default.jump(t))},sheetshow_fuc:function(){0!==this.goodsData.activity_id&&1==this.goodsData.is_apply&&this.bm_fuc(),this.sheetshow=!0,this.btnkg=0,this.$refs.popup_goods.open()},sheetshow1_fuc:function(){this.sheetshow1=!0,this.$refs.popup.open(),this.btnkg=0},gb_yhtk:function(){this.$refs.popup_yh.close()},tkchange0:function(t){console.log(t),this.sheetshow=t.show},tkchange:function(t){console.log(t),this.sheetshow=t.show},tkchange1:function(t){console.log(t),this.sheetshow1=t.show},qh_pl:function(t){console.log(t.currentTarget.dataset.idx),this.setData({pl_type:t.currentTarget.dataset.idx})},swiper_change:function(t){console.log(t.detail);var e=t.detail.current+1;this.setData({cur_swiper:e})},txtype_fuc:function(t){console.log(t.currentTarget.dataset.type),this.setData({dyr_type:t.currentTarget.dataset.type})},xz_dyr:function(){console.log(this.data.dyr_type),this.setData({sheetshow1:!1})},onClose:function(){this.sheetshow=!1,this.sheetshow1=!1,this.$refs.popup_goods.close()},addwgc:function(){var e=this;if(e.v_id&&e.guige_select.length==e.guige_arr.length){for(var o;o<e.guige_arr.length;o++)if("false"==e.guige_select[o])return void t.showToast({icon:"none",title:"请选择"+e.guige_arr[o].name});if(0!=e.cnum){if(console.log(e.cnum),console.log("addwgc"),1!=e.btnkg){e.btnkg=1;var i="/cart/add",s={token:e.loginMsg.userToken,g_id:e.g_id,v_id:e.v_id,advocacyId:e.dy_id,advocacyviceId:e.advocacyviceId,sum:e.cnum,advocacy_user_id:e.dyr_type};n.default.P_post(i,s).then((function(t){if(e.btn_kg=0,console.log(t),1==t.code){var o=t.data;"string"==typeof o&&(o=JSON.parse(o)),e.onClose(),wx.showToast({title:"添加成功"})}})).catch((function(o){e.btn_kg=0,console.log(o),t.showToast({icon:"none",title:"操作失败"})}))}}else t.showToast({icon:"none",title:"请添加购买数量"})}else t.showToast({icon:"none",title:"请选择规格"})},nowbuy:function(){var e=this;if(e.v_id&&e.guige_select.length==e.guige_arr.length){for(var o;o<e.guige_arr.length;o++)if("false"==e.guige_select[o])return void t.showToast({icon:"none",title:"请选择"+e.guige_arr[o].name});0!=e.cnum?(console.log(e.cnum),console.log("addwgc"),1!=e.btnkg&&(e.btnkg=1,e.onClose(),t.navigateTo({url:"/pagesA/Order/Order?type=1&v_id="+e.v_id+"&number="+e.cnum+"&advocacy_user_id="+e.dyr_type+"&v_id="+e.v_id+"&dy_id="+e.dy_id+"&advocacyviceId="+e.advocacyviceId}))):t.showToast({icon:"none",title:"请添加购买数量"})}else t.showToast({icon:"none",title:"请选择规格"})},bm_fuc:function(){var e=this;if(1!=e.btnkg){e.btnkg=1;var o={token:e.loginMsg.userToken,id:e.goodsData.activity_id};n.default.P_post("/activity/join",o).then((function(o){console.log(o),1==o.code?(e.btnkg=0,e.$set(e.goodsData,"is_apply",2),t.showToast({title:"报名成功"})):(e.btnkg=0,t.showToast({icon:"none",title:o.msg}))})).catch((function(o){e.btnkg=0,console.log(o),t.showToast({icon:"none",title:"操作失败"})}))}},call:function(t){n.default.call(t)},pveimg:function(t){n.default.pveimg(t)}}};e.default=u}).call(this,o("543d")["default"])},3029:function(t,e,o){"use strict";var n=function(t){t.options.wxsCallMethods||(t.options.wxsCallMethods=[])};e["a"]=n},"49bf":function(t,e,o){"use strict";o.r(e);var n=o("1a5b"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"49d3":function(t,e,o){"use strict";var n=o("f987"),i=o.n(n);i.a},"4ba6":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return n}));var n={uniPopup:function(){return Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup")]).then(o.bind(null,"f66d"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.guige_arr,(function(e,o){var n=t.__get_orig(e),i=t.guige_arr.length>0?t.__map(e.value,(function(n,i){var s=t.__get_orig(n),a=t.ggShow(e.name,n,o),c=a?t.ggShow(e.name,n,o):null,r=a?null:t.ggShow(e.name,n,o);return{$orig:s,m0:a,m1:c,m2:r}})):null;return{$orig:n,l0:i}})));t.$mp.data=Object.assign({},{$root:{l1:o}})},s=[]},"9e3b":function(t,e,o){"use strict";(function(t){o("72bd");n(o("66fd"));var e=n(o("0c53"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},f987:function(t,e,o){}},[["9e3b","common/runtime","common/vendor"]]]);