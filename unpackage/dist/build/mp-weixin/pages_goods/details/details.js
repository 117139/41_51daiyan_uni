(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages_goods/details/details"],{"0769":function(t,e,o){"use strict";var n=function(t){t.options.wxsCallMethods||(t.options.wxsCallMethods=[])};e["a"]=n},1618:function(t,e,o){"use strict";o.r(e);var n=o("e3d1"),i=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,(function(){return n[t]}))}(s);e["default"]=i.a},"1bfd":function(t,e,o){"use strict";o.r(e);var n=o("d7aa"),i=o("1618");for(var s in i)"default"!==s&&function(t){o.d(e,t,(function(){return i[t]}))}(s);o("d3d9");var a,g=o("f0c5"),c=o("0769"),r=Object(g["a"])(i["default"],n["b"],n["c"],!1,null,"eac09f48",null,!1,n["a"],a);"function"===typeof c["a"]&&Object(c["a"])(r),e["default"]=r.exports},"9f0b":function(t,e,o){"use strict";(function(t){o("72bd");n(o("66fd"));var e=n(o("1bfd"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},ae72:function(t,e,o){},d3d9:function(t,e,o){"use strict";var n=o("ae72"),i=o.n(n);i.a},d7aa:function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return n}));var n={uniPopup:function(){return Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup")]).then(o.bind(null,"f66d"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,t.__map(t.guige_arr,(function(e,o){var n=t.__get_orig(e),i=t.guige_arr.length>0?t.__map(e.value,(function(n,i){var s=t.__get_orig(n),a=t.ggShow(e.name,n,o),g=a?t.ggShow(e.name,n,o):null,c=a?null:t.ggShow(e.name,n,o);return{$orig:s,m0:a,m1:g,m2:c}})):null;return{$orig:n,l0:i}})));t.$mp.data=Object.assign({},{$root:{l1:o}})},s=[]},e3d1:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(o("b704")),i=o("2f62");function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function g(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach((function(e){c(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function c(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var r,l=function(){Promise.all([o.e("common/vendor"),o.e("components/uni-popup/uni-popup")]).then(function(){return resolve(o("f66d"))}.bind(null,o)).catch(o.oe)},u={data:function(){return{btn_kg:0,htmlReset:0,g_id:"",dy_id:"",advocacyviceId:"",v_id:"",indicatorDots:!1,autoplay:!1,circular:!0,interval:3e3,duration:1e3,data_list:[],yh_list:[],cur_swiper:1,star_list:[],star_page:1,size:20,StarText_list:[],StarText_page:1,LaterBuy_list:[],LaterBuy_page:1,sheetshow:!1,sheetshow1:!1,dyr_type:0,showcan:!1,goods_total_limit:"",goodsData:"",guige_arr:[],guige_arr_show:[],guige_select:[],guige:[],show_pri:0,show_img:0,show_num:0,type1:[-1],ggshow1_jjj:[],cnum:0,goods_sku_id:0,page:1,like_goods:[],share_id:"",live_type:""}},components:{uniPopup:l},computed:g(g({},(0,i.mapState)(["hasLogin","loginMsg","wxlogin"])),{},{ggshow1:function(){var t=this.guige_select;if(t){for(var e=[],o=0;o<t.length;o++)t[o]&&t[o].value&&e.push(t[o].value);return console.log(e.join(",")),e.join(",")}}}),onLoad:function(e){r=this,this.g_id=e.id,t.showLoading({title:"正在加载中"}),t.setNavigationBarTitle({title:"正在加载中..."}),this.getyhlist(),1==e.live&&(this.live_type=1),e.dy_id&&(this.dy_id=e.dy_id),e.advocacyviceId&&(this.advocacyviceId=e.advocacyviceId),e.share_id&&(this.share_id=e.share_id,console.log("share_id----------------------------\x3e"),console.log(e.share_id)),this.onRetry()},onShow:function(){this.btnkg=0},onPullDownRefresh:function(){this.getyhlist(),this.onRetry()},onReachBottom:function(){2==this.htmlReset&&this.getdatalist()},onShareAppMessage:function(){return r.loginMsg?{title:"51代言",path:"/pages_goods/details/details?share_id="+r.loginMsg.id+"&id="+r.g_id,success:function(t){console.log("成功",t)}}:{title:"51代言",path:"/pages_goods/details/details?id="+r.g_id,success:function(t){console.log("成功",t)}}},onShareTimeline:function(){return r.loginMsg?{title:"我是代言人，邀您领红包！",imageUrl:r.$store.state.loginMsg.avatarurl,query:"pid="+r.loginMsg.id+"&share_id="+r.loginMsg.id+"&id="+r.g_id}:{title:"我是代言人，邀您领红包！",query:"id="+r.g_id}},methods:{getdatalist:function(){var e=this,o="/goods/getGoodsList",i={token:e.loginMsg.userToken,page:e.page,cateId:3};e.data_last||1!=e.btn_kg&&(e.btn_kg=1,n.default.P_get(o,i).then((function(t){if(e.btn_kg=0,console.log(t),1==t.code){var o=t.data;if("string"==typeof o&&(o=JSON.parse(o)),0==o.length)return void(1==e.page?e.like_goods=o:e.data_last=!0);1==e.page?e.like_goods=o:e.like_goods=e.like_goods.concat(o),e.page++}})).catch((function(o){e.btn_kg=0,console.log(o),t.showToast({icon:"none",title:"获取数据失败"})})))},toroom:function(e){this.hasLogin?(this.$store.commit("createConversationActive",e),t.navigateTo({url:"/pages/tim/room?id="+e+"&type=2&goods_id="+this.g_id+"&goods_name="+this.goodsData.title+"&goods_img="+this.goodsData.img[0]+"&goods_pri="+this.goodsData.current_price})):t.navigateTo({url:"/pagesA/login/login"})},yhq_get:function(){0!=this.yh_list.length?this.$refs.popup_yh.open():t.showToast({icon:"none",title:"此商品暂无优惠"})},get_yh:function(e){var o=this,i={token:o.loginMsg.userToken,id:e};n.default.P_post("/goods/getCoupon",i).then((function(e){console.log(e),o.btnkg=0,-1!=e.code&&(0!=e.code||"请先登录账号~"!=e.msg)?1==e.code&&(o.getyhlist(),t.showToast({icon:"none",title:"领取成功"})):t.navigateTo({url:"/pagesA/login/login"})})).catch((function(e){o.btnkg=0,console.log(e),t.showToast({icon:"none",title:"操作失败"})}))},onRetry:function(){this.getSku(),this.star_page=1,this.getStarlist(),this.StarText_page=1,this.getStarTextlist(),this.LaterBuy_page=1,this.getLaterBuylist(),this.page=1,this.like_goods=[],this.getdatalist()},getyhlist:function(){var e=this,o=this,i="/goods/goodsCoupon",s={gid:o.g_id,token:o.loginMsg.userToken?o.loginMsg.userToken:""};n.default.P_get(i,s).then((function(t){if(o.btn_kg=0,console.log(t),1==t.code){var n=t.data;if("string"==typeof n&&(n=JSON.parse(n)),o.yh_list=n,n.length>0){for(var i=!0,s=0;s<n.length;s++)1==n[s].is_get&&(i=!1);i&&e.$refs.popup_yh.open()}o.btn_kg=0}})).catch((function(e){o.btn_kg=0,console.log(e),t.showToast({icon:"none",title:"获取数据失败"})}))},getStarlist:function(){var e=this,o="/goods/goodsAdvoacyUserDetail",i={gid:e.g_id,advocacyId:e.dy_id||"",advocacyviceId:e.advocacyviceId||"",share_id:e.share_id||"",token:e.loginMsg.userToken?e.loginMsg.userToken:"",page:e.star_page,size:e.size};n.default.P_get(o,i).then((function(o){if(e.btn_kg=0,console.log(o),1==o.code){var n=o.data;if("string"==typeof n&&(n=JSON.parse(n)),0==n.length)return e.star_page>1&&t.showToast({icon:"none",title:"暂无更多数据"}),void(e.btn_kg=0);1==e.star_page?(e.star_list=n,e.dyr_type=n[0].user_id):e.star_list=e.star_list.concat(n),e.btn_kg=0,e.star_page++}})).catch((function(o){e.btn_kg=0,console.log(o),t.showToast({icon:"none",title:"获取数据失败"})}))},getStarTextlist:function(){var e=this,o="/goods/advocacySay",i={gid:e.g_id,token:e.loginMsg.userToken?e.loginMsg.userToken:"",page:e.StarText_page,size:e.size};n.default.P_get(o,i).then((function(o){if(e.btn_kg=0,console.log(o),1==o.code){var n=o.data;if("string"==typeof n&&(n=JSON.parse(n)),0==n.length)return e.StarText_page>1&&t.showToast({icon:"none",title:"暂无更多数据"}),void(e.btn_kg=0);1==e.StarText_page?e.StarText_list=n:e.StarText_list=e.StarText_list.concat(n),e.btn_kg=0,e.StarText_page++}})).catch((function(o){e.btn_kg=0,console.log(o),t.showToast({icon:"none",title:"获取数据失败"})}))},getLaterBuylist:function(){var e=this,o="/goods/LaterBuy",i={gid:e.g_id,token:e.loginMsg.userToken?e.loginMsg.userToken:"",page:e.LaterBuy_page,size:e.size};n.default.P_get(o,i).then((function(o){if(e.btn_kg=0,console.log(o),1==o.code){var n=o.data;if("string"==typeof n&&(n=JSON.parse(n)),0==n.length)return e.LaterBuy_page>1&&t.showToast({icon:"none",title:"暂无更多数据"}),void(e.btn_kg=0);1==e.LaterBuy_page?e.LaterBuy_list=n:e.LaterBuy_list=e.LaterBuy_list.concat(n),e.btn_kg=0,e.LaterBuy_page++}})).catch((function(o){e.btn_kg=0,console.log(o),t.showToast({icon:"none",title:"获取数据失败"})}))},scFuc:function(e,o){var i=this,s={token:i.loginMsg.userToken,type:5,id:e,operate:o};"affirm"!=o?wx.showModal({title:"提示",content:"是否取消收藏?",success:function(e){e.confirm?(console.log("用户点击确定"),n.default.P_post("/attention/operation",s).then((function(e){console.log(e),i.btnkg=0,-1!=e.code&&(0!=e.code||"请先登录账号~"!=e.msg)?1==e.code&&(i.getSku(),t.showToast({icon:"none",title:"操作成功"})):t.navigateTo({url:"/pagesA/login/login"})})).catch((function(e){i.btnkg=0,console.log(e),t.showToast({icon:"none",title:"操作失败"})}))):e.cancel&&console.log("用户点击取消")}}):n.default.P_post("/attention/operation",s).then((function(e){console.log(e),i.btnkg=0,-1!=e.code&&(0!=e.code||"请先登录账号~"!=e.msg)?1==e.code&&(i.getSku(),t.showToast({icon:"none",title:"操作成功"})):t.navigateTo({url:"/pagesA/login/login"})})).catch((function(e){i.btnkg=0,console.log(e),t.showToast({icon:"none",title:"操作失败"})}))},guanzhuFuc:function(e,o){var i=this,s={token:i.loginMsg.userToken,type:1,id:e,operate:o};"affirm"!=o?wx.showModal({title:"提示",content:"是否取消关注?",success:function(e){e.confirm?(console.log("用户点击确定"),n.default.P_post("/attention/operation",s).then((function(e){console.log(e),i.btnkg=0,-1!=e.code&&(0!=e.code||"请先登录账号~"!=e.msg)?1==e.code&&(i.getSku(),t.showToast({icon:"none",title:"操作成功"})):t.navigateTo({url:"/pagesA/login/login"})})).catch((function(e){i.btnkg=0,console.log(e),t.showToast({icon:"none",title:"操作失败"})}))):e.cancel&&console.log("用户点击取消")}}):n.default.P_post("/attention/operation",s).then((function(e){console.log(e),i.btnkg=0,-1!=e.code&&(0!=e.code||"请先登录账号~"!=e.msg)?1==e.code&&(i.getSku(),t.showToast({icon:"none",title:"操作成功"})):t.navigateTo({url:"/pagesA/login/login"})})).catch((function(e){i.btnkg=0,console.log(e),t.showToast({icon:"none",title:"操作失败"})}))},getSku:function(){var e=this,o={token:e.loginMsg.userToken?e.loginMsg.userToken:"",id:e.g_id};n.default.P_get("/goods/details",o).then((function(o){if(console.log(o),1==o.code){e.htmlReset=0;var n=JSON.stringify(o.data.attr.sku_all),i=JSON.stringify(o.data.attr.specification);console.log(n),e.guige=JSON.parse(n),e.guige_arr_show=JSON.parse(i),e.guige_arr=o.data.attr.specification,e.goodsData=o.data,e.show_img=o.data.img,e.show_pri=o.data.current_price,e.show_num=0,t.setNavigationBarTitle({title:"商品详情"})}else t.setNavigationBarTitle({title:"商品详情"}),(o.msg="商品已下架")?e.htmlReset=2:e.htmlReset=1})).catch((function(o){console.log(o),e.htmlReset=1,t.showToast({icon:"none",title:"获取数据失败"})}))},ggShow:function(t,e,o){for(var n=this,i={name:t,value:e},s=[],a=0;a<n.guige.length;a++){for(var g=JSON.stringify(n.guige[a].sku),c=!0,r=0;r<n.guige_arr.length;r++){var l=!1;if(n.guige_select[r]&&(l=JSON.stringify(n.guige_select[r])),r==o&&(l=JSON.stringify(i)),l&&"false"!=l){if(-1==g.indexOf(l)){c=!1;break}}else c=!0}c&&s.push(n.guige[a])}return s.length>0},selegg:function(t){var e=this;console.log(t.currentTarget.dataset.value);var o={name:t.currentTarget.dataset.name,value:t.currentTarget.dataset.value},n=JSON.stringify(e.guige_select),i=JSON.stringify(o),s=!1;-1==n.indexOf(i)?e.$set(e.guige_select,t.currentTarget.dataset.ggidx,o):(e.$set(e.guige_select,t.currentTarget.dataset.ggidx,!1),s=!0);for(var a=[],g=0;g<e.guige.length;g++){n=JSON.stringify(e.guige[g].sku);for(var c=!0,r=0;r<e.guige_select.length;r++)if(e.guige_select[r]){i=JSON.stringify(e.guige_select[r]);if(i.length>0&&-1==n.indexOf(i)){c=!1;break}}else c=!0;c&&a.push(e.guige[g])}console.log(a);t.currentTarget.dataset.ggidx;var l=0,u=0,d="";for(g=0;g<a.length;g++)l+=a[g].number,0==u&&(e.v_id=a[g].v_id,s&&(e.v_id=0),u=a[g].current_price),""==d&&(d=a[g].v_img);e.show_pri=u,e.show_num=l,l<e.cnum&&(e.cnum=l),l>0&&0==e.cnum&&(e.cnum=1),e.show_img=d,0==e.show_img.length&&(e.show_img=e.goodsData.img),0==e.show_pri&&(e.show_pri=e.goodsData.current_price)},onChange:function(e){var o=this;if(0==o.guige_select.length)return t.showToast({icon:"none",title:"请先选择规格"}),void(this.cnum=0);this.cnum>this.show_num?this.cnum=this.show_num:this.cnum=e.detail},addwgc:function(){var e=this;if(e.v_id&&e.guige_select.length==e.guige_arr.length){for(var o;o<e.guige_arr.length;o++)if("false"==e.guige_select[o])return void t.showToast({icon:"none",title:"请选择"+e.guige_arr[o].name});if(0!=e.cnum){if(console.log(e.cnum),console.log("addwgc"),1!=e.btnkg){e.btnkg=1;var i="/cart/add",s={token:e.loginMsg.userToken,g_id:e.g_id,v_id:e.v_id,sum:e.cnum,advocacyId:e.dy_id,advocacyviceId:e.advocacyviceId,advocacy_user_id:e.dyr_type};n.default.P_post(i,s).then((function(t){if(e.btn_kg=0,console.log(t),1==t.code){var o=t.data;"string"==typeof o&&(o=JSON.parse(o)),e.onClose(),wx.showToast({title:"添加成功"})}})).catch((function(o){e.btn_kg=0,console.log(o),t.showToast({icon:"none",title:"操作失败"})}))}}else t.showToast({icon:"none",title:"请添加购买数量"})}else t.showToast({icon:"none",title:"请选择规格"})},nowbuy:function(){var e=this;if(e.v_id&&e.guige_select.length==e.guige_arr.length){for(var o;o<e.guige_arr.length;o++)if("false"==e.guige_select[o])return void t.showToast({icon:"none",title:"请选择"+e.guige_arr[o].name});0!=e.cnum?(console.log(e.cnum),console.log("addwgc"),1!=e.btnkg&&(e.btnkg=1,e.onClose(),t.navigateTo({url:"/pagesA/Order/Order?type=1&v_id="+e.v_id+"&number="+e.cnum+"&advocacy_user_id="+e.dyr_type+"&dy_id="+e.dy_id+"&advocacyviceId="+e.advocacyviceId}))):t.showToast({icon:"none",title:"请添加购买数量"})}else t.showToast({icon:"none",title:"请选择规格"})},bm_fuc:function(){var e=this;if(1!=e.btnkg){e.btnkg=1;var o={token:e.loginMsg.userToken,id:e.goodsData.activity_id};n.default.P_post("/activity/join",o).then((function(o){console.log(o),1==o.code?(e.btnkg=0,e.$set(e.goodsData,"is_apply",2),t.showToast({title:"报名成功"})):(e.btnkg=0,t.showToast({icon:"none",title:o.msg}))})).catch((function(o){e.btnkg=0,console.log(o),t.showToast({icon:"none",title:"操作失败"})}))}},jump:function(t){var e=this;1!=e.btn_kg&&(e.btn_kg=1,setTimeout((function(){e.btn_kg=0}),2e3),console.log(t.currentTarget.dataset.type),n.default.jump(t))},onClose:function(){this.sheetshow=!1,this.sheetshow1=!1,this.$refs.popup.close(),this.$refs.popup_goods.close()},sheetshow_fuc:function(){0!==this.goodsData.activity_id&&1==this.goodsData.is_apply&&this.bm_fuc(),this.sheetshow=!0,this.btnkg=0,this.$refs.popup_goods.open()},sheetshow1_fuc:function(){0!=this.star_list.length&&(this.sheetshow1=!0,this.$refs.popup.open(),this.btnkg=0)},gb_yhtk:function(){this.$refs.popup_yh.close()},tkchange0:function(t){console.log(t),this.sheetshow=t.show},tkchange:function(t){console.log(t),this.sheetshow=t.show},tkchange1:function(t){console.log(t),this.sheetshow1=t.show},swiper_change:function(t){var e=t.detail.current+1;this.cur_swiper=e},txtype_fuc:function(t){this.dyr_type==t||(this.dyr_type=t),console.log(this.dyr_type)},xz_dyr:function(){console.log(this.dyr_type),this.sheetshow1=!1,this.$refs.popup.close()},call:function(t){n.default.call(t)},pveimg:function(t){n.default.pveimg(t)}}};e.default=u}).call(this,o("543d")["default"])}},[["9f0b","common/runtime","common/vendor"]]]);