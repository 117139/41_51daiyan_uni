(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tim/room"],{68:
/*!*****************************************************************************!*\
  !*** E:/phpStudy/WWW/41_51daiyan_uni/main.js?{"page":"pages%2Ftim%2Froom"} ***!
  \*****************************************************************************/
/*! no static exports found */function(i,t,e){"use strict";(function(i){e(/*! uni-pages */4);n(e(/*! vue */2));var t=n(e(/*! ./pages/tim/room.vue */69));function n(i){return i&&i.__esModule?i:{default:i}}i(t.default)}).call(this,e(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},69:
/*!**********************************************************!*\
  !*** E:/phpStudy/WWW/41_51daiyan_uni/pages/tim/room.vue ***!
  \**********************************************************/
/*! no static exports found */function(i,t,e){"use strict";e.r(t);var n=e(/*! ./room.vue?vue&type=template&id=48d0d46b&filter-modules=eyJmaWx0ZXIiOnsidHlwZSI6InNjcmlwdCIsImNvbnRlbnQiOiIiLCJzdGFydCI6MTAzNDIsImF0dHJzIjp7Im1vZHVsZSI6ImZpbHRlciIsImxhbmciOiJ3eHMiLCJzcmMiOiIuLi8uLi91dGlscy9maWx0ZXIud3hzIn0sImVuZCI6MTAzNDJ9fQ%3D%3D& */70),o=e(/*! ./room.vue?vue&type=script&lang=js& */72);for(var s in o)"default"!==s&&function(i){e.d(t,i,(function(){return o[i]}))}(s);e(/*! ./room.vue?vue&type=style&index=0&lang=scss& */74);var a,g=e(/*! ../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */18),r=e(/*! ../../utils/filter.wxs?vue&type=custom&index=0&blockType=script&issuerPath=E%3A%5CphpStudy%5CWWW%5C41_51daiyan_uni%5Cpages%5Ctim%5Croom.vue&module=filter&lang=wxs */76),c=Object(g["default"])(o["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],a);"function"===typeof r["default"]&&Object(r["default"])(c),c.options.__file="pages/tim/room.vue",t["default"]=c.exports},70:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** E:/phpStudy/WWW/41_51daiyan_uni/pages/tim/room.vue?vue&type=template&id=48d0d46b&filter-modules=eyJmaWx0ZXIiOnsidHlwZSI6InNjcmlwdCIsImNvbnRlbnQiOiIiLCJzdGFydCI6MTAzNDIsImF0dHJzIjp7Im1vZHVsZSI6ImZpbHRlciIsImxhbmciOiJ3eHMiLCJzcmMiOiIuLi8uLi91dGlscy9maWx0ZXIud3hzIn0sImVuZCI6MTAzNDJ9fQ%3D%3D& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(i,t,e){"use strict";e.r(t);var n=e(/*! -!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=template&id=48d0d46b&filter-modules=eyJmaWx0ZXIiOnsidHlwZSI6InNjcmlwdCIsImNvbnRlbnQiOiIiLCJzdGFydCI6MTAzNDIsImF0dHJzIjp7Im1vZHVsZSI6ImZpbHRlciIsImxhbmciOiJ3eHMiLCJzcmMiOiIuLi8uLi91dGlscy9maWx0ZXIud3hzIn0sImVuZCI6MTAzNDJ9fQ%3D%3D& */71);e.d(t,"render",(function(){return n["render"]})),e.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),e.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),e.d(t,"components",(function(){return n["components"]}))},71:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/phpStudy/WWW/41_51daiyan_uni/pages/tim/room.vue?vue&type=template&id=48d0d46b&filter-modules=eyJmaWx0ZXIiOnsidHlwZSI6InNjcmlwdCIsImNvbnRlbnQiOiIiLCJzdGFydCI6MTAzNDIsImF0dHJzIjp7Im1vZHVsZSI6ImZpbHRlciIsImxhbmciOiJ3eHMiLCJzcmMiOiIuLi8uLi91dGlscy9maWx0ZXIud3hzIn0sImVuZCI6MTAzNDJ9fQ%3D%3D& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(i,t,e){"use strict";var n;e.r(t),e.d(t,"render",(function(){return o})),e.d(t,"staticRenderFns",(function(){return a})),e.d(t,"recyclableRender",(function(){return s})),e.d(t,"components",(function(){return n}));var o=function(){var i=this,t=i.$createElement,e=(i._self._c,i.__map(i.msgList,(function(t,e){var n=i.nodesFliter(t.payload.text),o=i.getarg(t.payload.extension,"a",t.payload.data),s=i.getarg(t.payload.extension,"a1",t.payload.data),a=i.getarg(t.payload.extension,"a2",t.payload.data),g=i.getarg(t.payload.extension,"a3",t.payload.data),r=i.getarg(t.payload.extension,"a2",t.payload.data),c=i.getarg(t.payload.extension,"a3",t.payload.data),f=i.getarg(t.payload.extension,"a",t.payload.data),l=i.timeFliter(t.time),d=i.gettime1(e-1),u=i.nodesFliter(t.payload.text),h=i.getarg(t.payload.extension,"a",t.payload.data),p=i.getarg(t.payload.extension,"a1",t.payload.data),m=i.getarg(t.payload.extension,"a2",t.payload.data),b=i.getarg(t.payload.extension,"a3",t.payload.data),A=i.getarg(t.payload.extension,"a2",t.payload.data),v=i.getarg(t.payload.extension,"a3",t.payload.data),y=i.getarg(t.payload.extension,"a",t.payload.data);return{$orig:i.__get_orig(t),m0:n,m1:o,m2:s,m3:a,m4:g,m5:r,m6:c,m7:f,m8:l,m9:d,m10:u,m11:h,m12:p,m13:m,m14:b,m15:A,m16:v,m17:y}})));i._isMounted||(i.e0=function(t){i.isFocus=!0},i.e1=function(t){i.isFocus=!1}),i.$mp.data=Object.assign({},{$root:{l0:e}})},s=!1,a=[];o._withStripped=!0},72:
/*!***********************************************************************************!*\
  !*** E:/phpStudy/WWW/41_51daiyan_uni/pages/tim/room.vue?vue&type=script&lang=js& ***!
  \***********************************************************************************/
/*! no static exports found */function(i,t,e){"use strict";e.r(t);var n=e(/*! -!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=script&lang=js& */73),o=e.n(n);for(var s in n)"default"!==s&&function(i){e.d(t,i,(function(){return n[i]}))}(s);t["default"]=o.a},73:
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/phpStudy/WWW/41_51daiyan_uni/pages/tim/room.vue?vue&type=script&lang=js& ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(i,t,e){"use strict";(function(i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(e(/*! ../../service.js */8)),o=e(/*! vuex */10);s(e(/*! ../../commen/tim/user.js */15));function s(i){return i&&i.__esModule?i:{default:i}}function a(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),e.push.apply(e,n)}return e}function g(i){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?a(Object(e),!0).forEach((function(t){r(i,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach((function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))}))}return i}function r(i,t,e){return t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}var c={data:function(){return{msg_type:1,goods_id:"",goods_name:"",goods_img:"",goods_pri:"",conversationActive:null,toUserId:"",toUserInfo:null,userInfo:null,nextReqMessageID:"",count:15,isCompleted:"",msgList:[],TIM:null,textMsg:"",isHistoryLoading:!1,scrollAnimation:!1,scrollTop:0,scrollToView:"",msgImgList:[],myuid:0,RECORDER:i.getRecorderManager(),isVoice:!1,voiceTis:"按住 说话",recordTis:"手指上滑 取消发送",recording:!1,willStop:!1,initPoint:{identifier:0,Y:0},recordTimer:null,recordLength:0,AUDIO:i.createInnerAudioContext(),playMsgid:null,VoiceTimer:null,popupLayerClass:"",hideMore:!0,hideEmoji:!0,emojiList:this.$commen.emojiList,onlineEmoji:{"100.gif":"AbNQgA.gif","101.gif":"AbN3ut.gif","102.gif":"AbNM3d.gif","103.gif":"AbN8DP.gif","104.gif":"AbNljI.gif","105.gif":"AbNtUS.gif","106.gif":"AbNGHf.gif","107.gif":"AbNYE8.gif","108.gif":"AbNaCQ.gif","109.gif":"AbNN4g.gif","110.gif":"AbN0vn.gif","111.gif":"AbNd3j.gif","112.gif":"AbNsbV.gif","113.gif":"AbNwgs.gif","114.gif":"AbNrD0.gif","115.gif":"AbNDuq.gif","116.gif":"AbNg5F.gif","117.gif":"AbN6ET.gif","118.gif":"AbNcUU.gif","119.gif":"AbNRC4.gif","120.gif":"AbNhvR.gif","121.gif":"AbNf29.gif","122.gif":"AbNW8J.gif","123.gif":"AbNob6.gif","124.gif":"AbN5K1.gif","125.gif":"AbNHUO.gif","126.gif":"AbNIDx.gif","127.gif":"AbN7VK.gif","128.gif":"AbNb5D.gif","129.gif":"AbNX2d.gif","130.gif":"AbNLPe.gif","131.gif":"AbNjxA.gif","132.gif":"AbNO8H.gif","133.gif":"AbNxKI.gif","134.gif":"AbNzrt.gif","135.gif":"AbU9Vf.gif","136.gif":"AbUSqP.gif","137.gif":"AbUCa8.gif","138.gif":"AbUkGQ.gif","139.gif":"AbUFPg.gif","140.gif":"AbUPIS.gif","141.gif":"AbUZMn.gif","142.gif":"AbUExs.gif","143.gif":"AbUA2j.gif","144.gif":"AbUMIU.gif","145.gif":"AbUerq.gif","146.gif":"AbUKaT.gif","147.gif":"AbUmq0.gif","148.gif":"AbUuZV.gif","149.gif":"AbUliF.gif","150.gif":"AbU1G4.gif","151.gif":"AbU8z9.gif","152.gif":"AbU3RJ.gif","153.gif":"AbUYs1.gif","154.gif":"AbUJMR.gif","155.gif":"AbUadK.gif","156.gif":"AbUtqx.gif","157.gif":"AbUUZ6.gif","158.gif":"AbUBJe.gif","159.gif":"AbUdIO.gif","160.gif":"AbU0iD.gif","161.gif":"AbUrzd.gif","162.gif":"AbUDRH.gif","163.gif":"AbUyQA.gif","164.gif":"AbUWo8.gif","165.gif":"AbU6sI.gif","166.gif":"AbU2eP.gif","167.gif":"AbUcLt.gif","168.gif":"AbU4Jg.gif","169.gif":"AbURdf.gif","170.gif":"AbUhFS.gif","171.gif":"AbU5WQ.gif","172.gif":"AbULwV.gif","173.gif":"AbUIzj.gif","174.gif":"AbUTQs.gif","175.gif":"AbU7yn.gif","176.gif":"AbUqe0.gif","177.gif":"AbUHLq.gif","178.gif":"AbUOoT.gif","179.gif":"AbUvYF.gif","180.gif":"AbUjFU.gif","181.gif":"AbaSSJ.gif","182.gif":"AbUxW4.gif","183.gif":"AbaCO1.gif","184.gif":"Abapl9.gif","185.gif":"Aba9yR.gif","186.gif":"AbaFw6.gif","187.gif":"Abaiex.gif","188.gif":"AbakTK.gif","189.gif":"AbaZfe.png","190.gif":"AbaEFO.gif","191.gif":"AbaVYD.gif","192.gif":"AbamSH.gif","193.gif":"AbaKOI.gif","194.gif":"Abanld.gif","195.gif":"Abau6A.gif","196.gif":"AbaQmt.gif","197.gif":"Abal0P.gif","198.gif":"AbatpQ.gif","199.gif":"Aba1Tf.gif","200.png":"Aba8k8.png","201.png":"AbaGtS.png","202.png":"AbaJfg.png","203.png":"AbaNlj.png","204.png":"Abawmq.png","205.png":"AbaU6s.png","206.png":"AbaaXn.png","207.png":"Aba000.png","208.png":"AbarkT.png","209.png":"AbastU.png","210.png":"AbaB7V.png","211.png":"Abafn1.png","212.png":"Abacp4.png","213.png":"AbayhF.png","214.png":"Abag1J.png","215.png":"Aba2c9.png","216.png":"AbaRXR.png","217.png":"Aba476.png","218.png":"Abah0x.png","219.png":"Abdg58.png"},windowsState:"",redenvelopeData:{rid:null,from:null,face:null,blessing:null,money:null},customModalVisible:!1,customData:"",customDescription:"",customExtension:"",focusedInput:"",isShow:!1}},computed:g({},(0,o.mapState)({loginMsg:"loginMsg",hasLogin:"hasLogin",currentMessageList:function(i){return i.currentMessageList}})),watch:{currentMessageList:function(i,t){this.msgList=i,this.screenMsg(i,t)}},onLoad:function(t){var e=this;console.log(t.id),this.hasLogin?(console.log(t.goods_name),console.log(t.goods_img),console.log(t.goods_pri),this.goods_name=t.goods_name,this.goods_img=t.goods_img,this.goods_pri=t.goods_pri,this.goods_id=t.goods_id,t.type&&(this.msg_type=t.type),this.toUserId=t.id?t.id:this.$store.state.toUserId,this.conversationActive=this.$store.state.conversationActive,this.TIM=this.$TIM,this.getmsg(),this.getMsgList(),this.AUDIO.onEnded((function(i){e.playMsgid=null})),this.RECORDER.onStart((function(i){e.recordBegin(i)})),this.RECORDER.onStop((function(i){e.recordEnd(i)}))):i.navigateBack({delta:1})},onShow:function(){var i=this;i.isShow=!0,setTimeout((function(){i.scrollToBottom(),i.scrollTop=99999999999999,i.isHistoryLoading=!1}),500)},onUnload:function(){var i=this.tim.setMessageRead({conversationID:this.conversationActive.conversationID});i.then((function(i){console.log("全部已读")})).catch((function(i){console.warn("setMessageRead error:",i)}))},onPullDownRefresh:function(){i.stopPullDownRefresh()},methods:{getmsg:function(){var t=this,e={token:t.loginMsg.userToken,type:t.msg_type,id:t.toUserId};n.default.P_get("/getTx",e).then((function(e){console.log(e),1==e.code&&(t.toUserInfo=e.data,i.setNavigationBarTitle({title:e.data.name}))})).catch((function(t){console.log(t),i.showToast({icon:"none",title:"获取对方数据失败"})}))},gettime1:function(i){if(!(i<0)){console.log(i,i+1);var t=this.msgList[i].time,e=this.msgList[i+1].time;return console.log(this.getchattime(t),this.getchattime(e)),this.getchattime(t)!=this.getchattime(e)?this.getchattime(e):void 0}},jump:function(t){console.log(t),i.navigateTo({url:t.currentTarget.dataset.url})},onPullDownRefresh:function(){i.stopPullDownRefresh()},scrollToBottom:function(){this.isShow&&wx.pageScrollTo({scrollTop:9999999})},getarg:function(i,t,e){if("custom"!=e&&i){var n=/\\$/gi;i=i.replace(n,"");var o=JSON.parse(i);return o.hasOwnProperty(t)?o[t]:void 0}},nodesFliter:function(i){var t='<div class="ltbox_div" style="word-wrap:break-word;line-height:40upx;">'+i+"</div>";return t},timeFliter:function(i){var t=new Date(1e3*i),e=this.$commen.dateTimeFliter(t);return e},getchattime:function(i){if(i){var t=(new Date).getFullYear(),e=(new Date).getMonth()+1,n=(new Date).getDate();i=Number(1e3*i);var o=new Date(i),s=o.getFullYear(),a=o.getMonth()+1,g=o.getDate(),r=o.getHours(),c=o.getMinutes();return c<10&&(c="0"+c),console.log(o),s==t?a==e&&g==n?r+":"+c:a+"-"+g+" "+r+":"+c:s+"-"+a+"-"+g+" "+r+":"+c}},screenMsg:function(i,t){var e=this;if(i[0]&&t[0])if(i[0].ID!=t[0].ID&&i.length>=this.count){var n=i.length-t.length-1;this.$nextTick((function(){e.scrollToView=i[n].ID}))}else this.$nextTick((function(){e.scrollToView=i[i.length-1].ID}));else console.log("*****"),this.$nextTick((function(){e.scrollToView=i[i.length-1].ID,e.scrollTop=9999999}))},loadHistory:function(i){var t=this;this.isHistoryLoading=!0;var e=this.conversationActive.conversationID,n=this.tim.getMessageList({conversationID:e,nextReqMessageID:this.nextReqMessageID,count:this.count});n.then((function(i){t.$store.commit("unshiftCurrentMessageList",i.data.messageList),t.nextReqMessageID=i.data.nextReqMessageID,t.isCompleted=i.data.isCompleted,t.isHistoryLoading=!1}))},getMsgList:function(){var i=this,t=this.conversationActive.conversationID,e=this.tim.getMessageList({conversationID:t,count:this.count});e.then((function(t){console.log(t.data),t.data.nextReqMessageID&&(i.$store.commit("pushCurrentMessageList",t.data.messageList),i.nextReqMessageID=t.data.nextReqMessageID,i.isCompleted=t.data.isCompleted,i.scrollToView=t.data.messageList[t.data.messageList.length-1].ID)})),this.$nextTick((function(){this.scrollTop=9999,this.$nextTick((function(){this.scrollAnimation=!0}))}))},setPicSize:function(t){var e=i.upx2px(350),n=i.upx2px(350);if(t.w>e||t.h>n){var o=t.w/t.h;t.w=o>1?e:n*o,t.h=o>1?e/o:n}return t},showMore:function(){this.isVoice=!1,this.hideEmoji=!0,this.hideMore?(this.hideMore=!1,this.openDrawer()):this.hideDrawer()},openDrawer:function(){this.popupLayerClass="showLayer"},hideDrawer:function(){var i=this;this.popupLayerClass="",setTimeout((function(){i.hideMore=!0,i.hideEmoji=!0}),150)},chooseImage:function(){this.getImage("album")},camera:function(){this.getImage("camera")},handRedEnvelopes:function(){i.navigateTo({url:"HM-hand/HM-hand"}),this.hideDrawer()},getImage:function(t){var e=this;e.hideDrawer(),i.chooseImage({sourceType:[t],sizeType:["original","compressed"],count:1,success:function(i){e.sendMsg(i,"img")}})},chooseEmoji:function(){this.hideMore=!0,this.hideEmoji?(this.hideEmoji=!1,this.openDrawer()):this.hideDrawer()},addEmoji:function(i){this.textMsg+=i.alt},textareaFocus:function(){"showLayer"==this.popupLayerClass&&0==this.hideMore&&this.hideDrawer()},sendText:function(){if(this.hideDrawer(),this.textMsg){var i=this.replaceEmoji(this.textMsg),t={text:i};this.sendMsg(t,"text"),this.textMsg=""}},replaceEmoji:function(i){var t=this,e=i.replace(/\[([^(\]|\[)]*)\]/g,(function(i,e){console.log("item: "+i);for(var n=0;n<t.emojiList.length;n++)for(var o=t.emojiList[n],s=0;s<o.length;s++){var a=o[s];if(a.alt==i){var g="http://51daiyan.test.upcdn.net/static_s/51daiyan/img/emoji/",r='<img class="emoji_i" src="'+g+a.url+'">';return console.log("imgstr: "+r),r}}}));return e},sendMsg:function(i,t){var e,n=this;console.log("????"),console.log(t),e="custom"==t?this.tim.createCustomMessage({to:this.toUserId,conversationType:"C2C",payload:{data:i.data,description:i.description,extension:i.extension}}):"img"==t?this.tim.createImageMessage({to:this.toUserId,conversationType:"C2C",payload:{file:i}}):this.tim.createTextMessage({to:this.toUserId,conversationType:"C2C",payload:{text:i.text}}),console.log("????1"),this.$store.commit("pushCurrentMessageList",e);var o=this.tim.sendMessage(e);o.then((function(i){n.$nextTick((function(){n.scrollToView=i.data.message.ID,n.scrollToBottom()}))}),(function(i){console.log(i)}))},addTextMsg:function(i){this.msgList.push(i)},addVoiceMsg:function(i){this.msgList.push(i)},addImgMsg:function(i){i.msg.content=this.setPicSize(i.msg.content),this.msgImgList.push(i.msg.content.url),this.msgList.push(i)},addRedEnvelopeMsg:function(i){this.msgList.push(i)},addSystemTextMsg:function(i){this.msgList.push(i)},addSystemRedEnvelopeMsg:function(i){this.msgList.push(i)},openRedEnvelope:function(t,e){var n=this,o=t.content.rid;i.showLoading({title:"加载中..."}),console.log("index: "+e),setTimeout((function(){0==o?n.redenvelopeData={rid:0,from:"大黑哥",face:"/static/img/im/face/face.jpg",blessing:"恭喜发财，大吉大利",money:"已领完"}:(n.redenvelopeData={rid:1,from:"售后客服008",face:"/static/img/im/face/face_2.jpg",blessing:"恭喜发财",money:"0.01"},t.content.isReceived||(n.sendSystemMsg({text:"你领取了"+(t.userinfo.uid==n.myuid?"自己":t.userinfo.username)+"的红包"},"redEnvelope"),console.log("this.msgList[index]: "+JSON.stringify(n.msgList[e])),n.msgList[e].msg.content.isReceived=!0)),i.hideLoading(),n.windowsState="show"}),200)},closeRedEnvelope:function(){var i=this;this.windowsState="hide",setTimeout((function(){i.windowsState=""}),200)},sendSystemMsg:function(i,t){var e=this.msgList[this.msgList.length-1].msg.id;e++;var n={type:"system",msg:{id:e,type:t,content:i}};this.screenMsg(n)},toDetails:function(t){i.navigateTo({url:"HM-details/HM-details?rid="+t})},showPic:function(t){i.previewImage({indicator:"none",current:t.content.url,urls:this.msgImgList})},playVoice:function(i){this.playMsgid=i.id,this.AUDIO.src=i.content.url,this.$nextTick((function(){this.AUDIO.play()}))},voiceBegin:function(i){i.touches.length>1||(this.initPoint.Y=i.touches[0].clientY,this.initPoint.identifier=i.touches[0].identifier,this.RECORDER.start({format:"mp3"}))},recordBegin:function(i){var t=this;this.recording=!0,this.voiceTis="松开 结束",this.recordLength=0,this.recordTimer=setInterval((function(){t.recordLength++}),1e3)},voiceCancel:function(){this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.willStop=!0,this.RECORDER.stop()},voiceIng:function(t){if(this.recording){var e=t.touches[0];this.initPoint.Y-e.clientY>=i.upx2px(100)?(this.willStop=!0,this.recordTis="松开手指 取消发送"):(this.willStop=!1,this.recordTis="手指上滑 取消发送")}},voiceEnd:function(i){this.recording&&(this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.RECORDER.stop())},recordEnd:function(i){if(clearInterval(this.recordTimer),this.willStop)console.log("取消发送录音");else{console.log("e: "+JSON.stringify(i));var t={length:0,url:i.tempFilePath},e=parseInt(this.recordLength/60),n=this.recordLength%60;e=e<10?"0"+e:e,n=n<10?"0"+n:n,t.length=e+":"+n,this.sendMsg(t,"voice")}this.willStop=!1},switchVoice:function(){this.hideDrawer(),this.isVoice=!this.isVoice},discard:function(){},customModal:function(){var t=this;i.showModal({title:"提示",content:"是否发送此商品",success:function(i){if(i.confirm){console.log("用户点击确定");var e={a:t.goods_pri,a1:"a1",a2:"/pages/details/details?id="+t.goods_id,a3:n.default.imgurl+t.goods_img};e=JSON.stringify(e);var o={data:"custom_good",description:t.goods_name,extension:e};t.sendMsg(o,"custom")}else i.cancel&&console.log("用户点击取消")}})},handleClose:function(){this.rateModal=!1,this.isFocus=!1,this.isMoreOpen=!1,this.isEmojiOpen=!1},previmg:function(t){console.log(t);var e=[];e.push(t.currentTarget.dataset.url),i.previewImage({urls:e,longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(i){console.log("选中了第"+(i.tapIndex+1)+"个按钮,第"+(i.index+1)+"张图片")},fail:function(i){console.log(i.errMsg)}}})}}};t.default=c}).call(this,e(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},74:
/*!********************************************************************************************!*\
  !*** E:/phpStudy/WWW/41_51daiyan_uni/pages/tim/room.vue?vue&type=style&index=0&lang=scss& ***!
  \********************************************************************************************/
/*! no static exports found */function(i,t,e){"use strict";e.r(t);var n=e(/*! -!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src??ref--8-oneOf-1-3!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./room.vue?vue&type=style&index=0&lang=scss& */75),o=e.n(n);for(var s in n)"default"!==s&&function(i){e.d(t,i,(function(){return n[i]}))}(s);t["default"]=o.a},75:
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/phpStudy/WWW/41_51daiyan_uni/pages/tim/room.vue?vue&type=style&index=0&lang=scss& ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(i,t,e){},76:
/*!****************************************************************************************************************************************************************************************************!*\
  !*** E:/phpStudy/WWW/41_51daiyan_uni/utils/filter.wxs?vue&type=custom&index=0&blockType=script&issuerPath=E%3A%5CphpStudy%5CWWW%5C41_51daiyan_uni%5Cpages%5Ctim%5Croom.vue&module=filter&lang=wxs ***!
  \****************************************************************************************************************************************************************************************************/
/*! exports provided: default */function(i,t,e){"use strict";e.r(t);var n=e(/*! -!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-filter-loader!./filter.wxs?vue&type=custom&index=0&blockType=script&issuerPath=E%3A%5CphpStudy%5CWWW%5C41_51daiyan_uni%5Cpages%5Ctim%5Croom.vue&module=filter&lang=wxs */77);t["default"]=n["default"]},77:
/*!***********************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-filter-loader!E:/phpStudy/WWW/41_51daiyan_uni/utils/filter.wxs?vue&type=custom&index=0&blockType=script&issuerPath=E%3A%5CphpStudy%5CWWW%5C41_51daiyan_uni%5Cpages%5Ctim%5Croom.vue&module=filter&lang=wxs ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: default */function(i,t,e){"use strict";e.r(t),t["default"]=function(i){i.options.wxsCallMethods||(i.options.wxsCallMethods=[])}}},[[68,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/tim/room.js.map